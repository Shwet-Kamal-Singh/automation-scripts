#!/bin/bash

# vulnerability-scan.sh
# This script performs a vulnerability scan using Lynis on an Ubuntu-based system.

# Function to install Lynis if not already installed
install_lynis() {
    if ! command -v lynis &> /dev/null; then
        echo "Lynis is not installed. Installing Lynis..."
        sudo apt-get update -y
        sudo apt-get install lynis -y
    else
        echo "Lynis is already installed."
    fi
}

# Function to perform a vulnerability scan
perform_scan() {
    echo "Performing vulnerability scan with Lynis..."
    sudo lynis audit system
}

# Main script execution
echo "Starting vulnerability scan script..."

install_lynis
perform_scan

echo "Vulnerability scan completed."

# End of script